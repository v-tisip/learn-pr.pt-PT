<span data-ttu-id="fcc52-101">Imagine que está a planear a arquitetura da sua aplicação de partilha de música.</span><span class="sxs-lookup"><span data-stu-id="fcc52-101">Suppose you are planning the architecture for your music-sharing application.</span></span> <span data-ttu-id="fcc52-102">Deve optar por uma forma que garanta que o carregamento de ficheiros de música é feito da aplicação móvel para a API Web de forma viável.</span><span class="sxs-lookup"><span data-stu-id="fcc52-102">You want to choose ensure that music files are uploaded to the web API reliably from the mobile app.</span></span>

<span data-ttu-id="fcc52-103">Depois de ter compreendido que esta comunicação deve ser uma mensagem, tem de escolher entre as filas de Armazenamento do Azure e o Azure Service Bus, podendo ambos podem ser utilizados para armazenar as filas de mensagens enquanto aguardam processamento.</span><span class="sxs-lookup"><span data-stu-id="fcc52-103">Having understood that this communication should be a message, you must choose whether to use Azure Storage queues or Service Bus, both of which can be used to store queues of messages as they await processing.</span></span>

## <a name="delivery-guarantees"></a><span data-ttu-id="fcc52-104">Garantias de entrega</span><span class="sxs-lookup"><span data-stu-id="fcc52-104">Delivery Guarantees</span></span>

<span data-ttu-id="fcc52-105">Normalmente, os sistemas de colocação em fila garantem a entrega de cada mensagem na fila para um componente de destino.</span><span class="sxs-lookup"><span data-stu-id="fcc52-105">Queuing systems usually guarantee delivery of each message in the queue to a destination component.</span></span> <span data-ttu-id="fcc52-106">Contudo, estas garantias podem assumir diferentes abordagens:</span><span class="sxs-lookup"><span data-stu-id="fcc52-106">However, these guarantees can take different approaches:</span></span>

- <span data-ttu-id="fcc52-107">**Entrega No-Mínimo-Uma-Vez.**</span><span class="sxs-lookup"><span data-stu-id="fcc52-107">**At-Least-Once Delivery.**</span></span> <span data-ttu-id="fcc52-108">Nesta abordagem, é garantido que cada mensagem é entregue a, pelo menos, um dos componentes que obtém as mensagens da fila.</span><span class="sxs-lookup"><span data-stu-id="fcc52-108">In this approach, each message is guaranteed to be delivered to at least one of the components that retrieve messages from the queue.</span></span> <span data-ttu-id="fcc52-109">No entanto, note que em determinadas circunstâncias é possível que a mesma mensagem seja entregue mais de uma vez.</span><span class="sxs-lookup"><span data-stu-id="fcc52-109">Note, however, that in certain circumstances, it is possible that the same message may be delivered more than once.</span></span> <span data-ttu-id="fcc52-110">Por exemplo, se existirem duas instâncias de uma aplicação Web a obter mensagens de uma fila, normalmente cada mensagem vai para apenas uma das duas instâncias.</span><span class="sxs-lookup"><span data-stu-id="fcc52-110">For example, if there are two instances of a web app retrieving messages from a queue, ordinarily each message goes to only one of those instances.</span></span> <span data-ttu-id="fcc52-111">Contudo, se uma instância demorar muito tempo a processar a mensagem e o tempo limite expirar, a mensagem pode ser enviada para a outra instância também.</span><span class="sxs-lookup"><span data-stu-id="fcc52-111">However, if one instance takes a long time to process the message, and a time-out expires, the message may be sent to the other instance as well.</span></span> <span data-ttu-id="fcc52-112">O código da aplicação Web deve ser concebido com essa possibilidade em mente.</span><span class="sxs-lookup"><span data-stu-id="fcc52-112">Your web app code should be designed with this possibility in mind.</span></span>
- <span data-ttu-id="fcc52-113">**Entrega No-Máximo-Uma-Vez.**</span><span class="sxs-lookup"><span data-stu-id="fcc52-113">**At-Most-Once Delivery.**</span></span> <span data-ttu-id="fcc52-114">Nesta abordagem, não é garantido que cada mensagem seja entregue e há uma pequena hipótese que nem chegue ao destino.</span><span class="sxs-lookup"><span data-stu-id="fcc52-114">In this approach, each message is not guaranteed to be delivered and there is a very small chance that it may not arrive.</span></span> <span data-ttu-id="fcc52-115">Contudo, não há qualquer hipótese de que a mensagem seja enviada duas vezes, tal como acontece com a entrega No-Máximo-Uma-Vez.</span><span class="sxs-lookup"><span data-stu-id="fcc52-115">However, there is no chance that the message will be delivered twice as with At-Least-Once delivery.</span></span>
- <span data-ttu-id="fcc52-116">**Primeiro a Entrar, Primeiro a Sair (FIFO).**</span><span class="sxs-lookup"><span data-stu-id="fcc52-116">**First-In-First-Out (FIFO).**</span></span> <span data-ttu-id="fcc52-117">Na maioria dos sistema de mensagens, as mensagens deixam, normalmente, a fila pela mesma ordem em que foram adicionados, mas deve considerar se esta ordem é garantida.</span><span class="sxs-lookup"><span data-stu-id="fcc52-117">In most messaging system, messages usually leave the queue in the same order in which they were added but you should consider whether this order is guaranteed.</span></span> <span data-ttu-id="fcc52-118">Se a sua aplicação distribuída necessitar que as mensagens sejam processadas exatamente pela ordem correta, tem de escolher um sistema de fila que inclua uma garantia de FIFO.</span><span class="sxs-lookup"><span data-stu-id="fcc52-118">If your distributed application requires that messages are processed in precisely the correct order, you must choose a queue system that includes a FIFO guarantee.</span></span>

## <a name="transactions"></a><span data-ttu-id="fcc52-119">Transações</span><span class="sxs-lookup"><span data-stu-id="fcc52-119">Transactions</span></span>

<span data-ttu-id="fcc52-120">Alguns grupos de mensagens intimamente relacionados podem provocar problemas quando a entrega falha para uma mensagem no grupo.</span><span class="sxs-lookup"><span data-stu-id="fcc52-120">Some closely related groups of messages may cause problems when delivery fails for one message in the group.</span></span>

<span data-ttu-id="fcc52-121">Por exemplo, considere uma aplicação de comércio eletrónico.</span><span class="sxs-lookup"><span data-stu-id="fcc52-121">For example, consider an e-commerce application.</span></span> <span data-ttu-id="fcc52-122">Quando o utilizador clica no botão "Comprar", é enviada uma mensagem com os detalhes do pedido, juntamente com uma mensagem com os detalhes do cartão de crédito.</span><span class="sxs-lookup"><span data-stu-id="fcc52-122">When the user clicks the "Buy" button, a message with the order details is sent along with a message with the credit card details.</span></span> <span data-ttu-id="fcc52-123">Se a mensagem do cartão de crédito não for entregue, o pedido pode ser expedida sem pagamento.</span><span class="sxs-lookup"><span data-stu-id="fcc52-123">If the credit card message is not delivered, the order may be dispatched without payment.</span></span>

<span data-ttu-id="fcc52-124">Pode evitar este tipo de problemas, agrupando as duas mensagens numa transação.</span><span class="sxs-lookup"><span data-stu-id="fcc52-124">You can avoid these kinds of problems by grouping the two messages into a transaction.</span></span> <span data-ttu-id="fcc52-125">O sucesso ou fracasso das transações é medido enquanto unidade única.</span><span class="sxs-lookup"><span data-stu-id="fcc52-125">Transactions succeed or fail as a single unit.</span></span> <span data-ttu-id="fcc52-126">Se a entrega da mensagem de detalhes do cartão de crédito falhar, o mesmo acontecerá à mensagem de detalhes do pedido.</span><span class="sxs-lookup"><span data-stu-id="fcc52-126">If the credit card details message delivery fails then so will the order details message.</span></span>

## <a name="when-to-use-storage-queues"></a><span data-ttu-id="fcc52-127">Quando utilizar filas de armazenamento</span><span class="sxs-lookup"><span data-stu-id="fcc52-127">When to use Storage queues</span></span>

<span data-ttu-id="fcc52-128">As filas são utilizadas para mensagens, mas não eventos.</span><span class="sxs-lookup"><span data-stu-id="fcc52-128">Queues are used for messages but not events.</span></span>

<span data-ttu-id="fcc52-129">As Contas de Armazenamento do Azure incluem filas que podem ser utilizadas por aplicações distribuídas como localizações de armazenamento temporário simples para as mensagens.</span><span class="sxs-lookup"><span data-stu-id="fcc52-129">Azure Storage Accounts include queues, which can be used by distributed applications as simple temporary storage locations for messages.</span></span> <span data-ttu-id="fcc52-130">Um componente de origem pode adicionar uma mensagem à fila.</span><span class="sxs-lookup"><span data-stu-id="fcc52-130">A source component can add a message to the queue.</span></span> <span data-ttu-id="fcc52-131">Os componentes de destino obtêm a mensagem no início da fila para processamento.</span><span class="sxs-lookup"><span data-stu-id="fcc52-131">Destination components retrieve the message at the front of the queue for processing.</span></span> <span data-ttu-id="fcc52-132">Estas filas aumentam a fiabilidade de troca de mensagens, porque, em momentos de procura elevada, as mensagens podem simplesmente aguardar até que um componente de destino esteja pronto para as processar.</span><span class="sxs-lookup"><span data-stu-id="fcc52-132">Such queues increase the reliability of the message exchange because, at times of high demand, messages can simply wait until a destination component is ready to process them.</span></span>

<span data-ttu-id="fcc52-133">As filas são também fornecidas como parte das Mensagens do Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="fcc52-133">Queues are also provided as part of Azure Service Bus Messaging.</span></span> <span data-ttu-id="fcc52-134">Se decidiu utilizar uma fila no Azure para uma comunicação específica, tem de optar por utilizar uma fila de Armazenamento ou uma fila do Service Bus.</span><span class="sxs-lookup"><span data-stu-id="fcc52-134">If you have decided to use a queue in Azure for a specific communication, you must decide whether to use a Storage queue or a Service Bus queue.</span></span>

<span data-ttu-id="fcc52-135">Para tomar essa decisão, considere as seguintes perguntas:</span><span class="sxs-lookup"><span data-stu-id="fcc52-135">To make this choice, consider the following questions:</span></span>

- <span data-ttu-id="fcc52-136">Necessita de uma garantia de entrega No-Máximo-Uma-Vez?</span><span class="sxs-lookup"><span data-stu-id="fcc52-136">Do you need an At-Most-Once delivery guarantee?</span></span>
- <span data-ttu-id="fcc52-137">Necessita de uma garantia de FIFO?</span><span class="sxs-lookup"><span data-stu-id="fcc52-137">Do you need a FIFO guarantee?</span></span>
- <span data-ttu-id="fcc52-138">Necessita de agrupar mensagens em transações?</span><span class="sxs-lookup"><span data-stu-id="fcc52-138">Do you need to group messages into transactions?</span></span>
- <span data-ttu-id="fcc52-139">Necessita de armazenar mensagens com mais de 64 KB?</span><span class="sxs-lookup"><span data-stu-id="fcc52-139">Do you need to store messages larger than 64KB?</span></span>

<span data-ttu-id="fcc52-140">Se a resposta a alguma dessas perguntas for positiva, tem de optar por utilizar uma fila do Service Bus.</span><span class="sxs-lookup"><span data-stu-id="fcc52-140">If the answer to any of these questions is yes, you must choose to use a Service Bus queue.</span></span>

<span data-ttu-id="fcc52-141">Deve ainda considerar as seguintes questões:</span><span class="sxs-lookup"><span data-stu-id="fcc52-141">In addition consider:</span></span>

- <span data-ttu-id="fcc52-142">Necessita de registos do lado do servidor de todas as mensagens que passam pela fila?</span><span class="sxs-lookup"><span data-stu-id="fcc52-142">Do you need server-side logs of all messages that pass through the queue?</span></span>
- <span data-ttu-id="fcc52-143">Espera que a fila ultrapasse os 80 GB?</span><span class="sxs-lookup"><span data-stu-id="fcc52-143">Do you expect the queue to exceed 80GB in size?</span></span>

<span data-ttu-id="fcc52-144">Se a resposta a alguma dessas perguntas for positiva, tem de optar por uma fila do Service Bus.</span><span class="sxs-lookup"><span data-stu-id="fcc52-144">If the answer to any of these questions is yes, you must choose to use a Storage queue.</span></span>

## <a name="summary"></a><span data-ttu-id="fcc52-145">Resumo</span><span class="sxs-lookup"><span data-stu-id="fcc52-145">Summary</span></span>

<span data-ttu-id="fcc52-146">Uma fila é uma localização de armazenamento temporário simples para as mensagens enviadas entre os componentes de uma aplicação distribuída.</span><span class="sxs-lookup"><span data-stu-id="fcc52-146">A queue is a simple temporary storage location for messages sent between the components of a distributed application.</span></span> <span data-ttu-id="fcc52-147">Utilize uma fila para organizar as mensagens e processar facilmente aumentos inesperados da procura.</span><span class="sxs-lookup"><span data-stu-id="fcc52-147">Use a queue to organize message and gracefully handle unpredictable surges in demand.</span></span>

<span data-ttu-id="fcc52-148">Utilize as filas de Armazenamento do Azure se procura um sistema de fila simples e fácil de codificar.</span><span class="sxs-lookup"><span data-stu-id="fcc52-148">Use Azure Storage queues when you want a simple and easy-to-code queue system.</span></span> <span data-ttu-id="fcc52-149">Para necessidades mais avançadas, utilize filas do Service Bus do Azure.</span><span class="sxs-lookup"><span data-stu-id="fcc52-149">For more advanced needs, use Azure Service Bus queues.</span></span>