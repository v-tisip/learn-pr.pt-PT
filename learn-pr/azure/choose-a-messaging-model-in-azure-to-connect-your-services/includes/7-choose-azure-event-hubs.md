<span data-ttu-id="b2b70-101">Há determinadas aplicações que produzem um grande número de eventos a partir de um número semelhante de origens.</span><span class="sxs-lookup"><span data-stu-id="b2b70-101">There are certain applications that produce a massive number of events from almost as many sources.</span></span> <span data-ttu-id="b2b70-102">Ouvimos, recorrentemente, o termo "Macrodados" aplicado a estas situações, que exigem uma infraestrutura exclusiva para processamento.</span><span class="sxs-lookup"><span data-stu-id="b2b70-102">We often hear the term "Big Data" applied to these situations and they require unique infrastructure to handle them.</span></span>

<span data-ttu-id="b2b70-103">Imagine que trabalha para a Contoso Aircraft Engines.</span><span class="sxs-lookup"><span data-stu-id="b2b70-103">Imagine you work for Contoso Aircraft Engines.</span></span> <span data-ttu-id="b2b70-104">Os motores que o seu empregador fabrica têm centenas de sensores.</span><span class="sxs-lookup"><span data-stu-id="b2b70-104">The engines your employer manufactures have hundreds of sensors.</span></span> <span data-ttu-id="b2b70-105">Para que uma aeronave possa voar todas as manhãs, primeiro, os respetivos motores são ligados a um conjunto de teste e postos à prova.</span><span class="sxs-lookup"><span data-stu-id="b2b70-105">Before an aircraft can be flown each morning, its engines are connected to a test harness and put through their paces.</span></span> <span data-ttu-id="b2b70-106">Além disso, os dados de voo em cache são transmitidos quando a aeronave está ligada aos equipamentos de terra.</span><span class="sxs-lookup"><span data-stu-id="b2b70-106">Additionally, cached in-flight data is streamed when the aircraft is connected to ground equipment.</span></span>

<span data-ttu-id="b2b70-107">Pretende utilizar o histórico dos dados do sensor para detetar padrões na leituras do sensor que indiquem a possibilidade eminente de falhas do motor.</span><span class="sxs-lookup"><span data-stu-id="b2b70-107">You want to use historic sensor data to find patterns in the sensor readings that indicate engine failure is likely to happen soon.</span></span> <span data-ttu-id="b2b70-108">Pretende que as leituras do sensor em tempo real sejam comparadas com estes padrões de falha.</span><span class="sxs-lookup"><span data-stu-id="b2b70-108">You want the real-time sensor readings to be compared against these failure patterns.</span></span> <span data-ttu-id="b2b70-109">Em seguida, pode avisar os utilizadores em tempo real, caso um motor apresente leituras preocupantes.</span><span class="sxs-lookup"><span data-stu-id="b2b70-109">You can then warn users in near real time if an engine is showing worrisome readings.</span></span>

## <a name="what-is-azure-event-hubs"></a><span data-ttu-id="b2b70-110">O que são Hubs de Eventos do Azure?</span><span class="sxs-lookup"><span data-stu-id="b2b70-110">What is Azure Event Hubs</span></span>

<span data-ttu-id="b2b70-111">Um Hub de Eventos do Azure é um intermediário para o padrão de comunicação publicar-subscrever, mas, ao contrário do Event Grid, está otimizado para um débito extremamente alto, um elevado número de publicadores, segurança e resiliência.</span><span class="sxs-lookup"><span data-stu-id="b2b70-111">Azure Event Hub is an intermediary for the publish-subscribe communication pattern, but unlike Event Grid it is optimized for extremely high throughput, a large number of publishers, security, and resiliency.</span></span>

<span data-ttu-id="b2b70-112">Ao passo que o Event Grid se adapta de forma mais ou menos perfeita ao padrão publicar-subscrever, em que simplesmente gere subscrições e encaminha comunicações para os subscritores, o Hub de Eventos executa alguns serviços adicionais que, em certa medida, fazem com que se assemelhe mais a um serviço de barramento ou a uma fila de mensagens do que um simples emissor de eventos.</span><span class="sxs-lookup"><span data-stu-id="b2b70-112">Whereas Event Grid fits more or less perfectly into the publish-subscribe pattern in that it simply manages subscriptions and routes communications to those subscribers, Event Hub performs quite a few additional services that in some ways make it resemble a service bus or message queue more than a simple event broadcaster.</span></span>

#### <a name="partitions"></a><span data-ttu-id="b2b70-113">Partições</span><span class="sxs-lookup"><span data-stu-id="b2b70-113">Partitions</span></span> ####
<span data-ttu-id="b2b70-114">À medida que o Hub de Eventos recebe comunicações, vai dividi-las em partições.</span><span class="sxs-lookup"><span data-stu-id="b2b70-114">As Event Hub receives communications it divides them into partitions.</span></span> <span data-ttu-id="b2b70-115">As partições são memórias intermédias nas quais são guardadas as comunicações.</span><span class="sxs-lookup"><span data-stu-id="b2b70-115">Partitions are buffers into which the communications are saved.</span></span> <span data-ttu-id="b2b70-116">Por causa das memórias intermédias, os eventos não são completamente efémeros e um evento não é perdido, só porque um subscritor está ocupado ou offline.</span><span class="sxs-lookup"><span data-stu-id="b2b70-116">Because of the event buffers, events are not completely ephemeral and an event isn't missed just because a subscriber is busy or even offline.</span></span> <span data-ttu-id="b2b70-117">O subscritor pode sempre utilizar a memória intermédia para "recuperar o atraso".</span><span class="sxs-lookup"><span data-stu-id="b2b70-117">The subscriber can always use the buffer to "catch up".</span></span> <span data-ttu-id="b2b70-118">Por predefinição, os eventos permanecem na memória intermédia durante 24 horas e, em seguida, expirarem automaticamente.</span><span class="sxs-lookup"><span data-stu-id="b2b70-118">By default events stay in the buffer for 24 hours then automatically expire.</span></span>

<span data-ttu-id="b2b70-119">As memórias intermédias são chamadas de partições, porque os dados estão divididos entre elas.</span><span class="sxs-lookup"><span data-stu-id="b2b70-119">The buffers are called partitions because the data is divided amongst them.</span></span> <span data-ttu-id="b2b70-120">Cada Hub de Eventos tem, pelo menos, duas partições e cada partição tem um conjunto de subscritores separado.</span><span class="sxs-lookup"><span data-stu-id="b2b70-120">Every Event Hub has at least two partitions, and each partition has a separate set of subscribers.</span></span>

#### <a name="capture"></a><span data-ttu-id="b2b70-121">Captura</span><span class="sxs-lookup"><span data-stu-id="b2b70-121">Capture</span></span> ####
<span data-ttu-id="b2b70-122">O Hub de Eventos pode enviar todos os seus eventos imediatamente para o Azure Data Lake ou Armazenamento de Blobs para uma persistência permanente de baixo custo.</span><span class="sxs-lookup"><span data-stu-id="b2b70-122">Event Hub can send all your events immediately to Azure Data Lake or Blob Storage for inexpensive permanent persistence.</span></span>

#### <a name="authentication"></a><span data-ttu-id="b2b70-123">Autenticação</span><span class="sxs-lookup"><span data-stu-id="b2b70-123">Authentication</span></span> ####
<span data-ttu-id="b2b70-124">Todos os editores são autenticados e é-lhes emitido um token.</span><span class="sxs-lookup"><span data-stu-id="b2b70-124">All publishers are authenticated and issued a token.</span></span> <span data-ttu-id="b2b70-125">Tal significa que o Hub de Eventos pode aceitar eventos a partir de dispositivos externos e aplicações móveis sem se preocupar com a possibilidade de dados fraudulentos poderem arruinar a nossa análise.</span><span class="sxs-lookup"><span data-stu-id="b2b70-125">This means Event Hub can accept events from external devices and mobile apps without worrying that fraudulent data from pranksters could ruin our analysis.</span></span> 

## <a name="using-azure-event-hub"></a><span data-ttu-id="b2b70-126">Utilizar o Hub de Eventos do Azure</span><span class="sxs-lookup"><span data-stu-id="b2b70-126">Using Azure Event Hub</span></span>

<span data-ttu-id="b2b70-127">Os Hubs de Eventos têm suporte para pipelining da transmissão de eventos para outros serviços do Azure.</span><span class="sxs-lookup"><span data-stu-id="b2b70-127">Event Hubs has support for pipelining event streams to other Azure services.</span></span> <span data-ttu-id="b2b70-128">Utilizá-lo com o Stream Analytics, por exemplo, permite uma análise complexa dos dados em tempo real com capacidade para correlacionar vários eventos e procurar padrões.</span><span class="sxs-lookup"><span data-stu-id="b2b70-128">Using it with Stream Analytics for instance allows complex analysis of data in near real time with the ability to correlate multiple events and look for patterns.</span></span> <span data-ttu-id="b2b70-129">Neste caso, o Stream Analytics seria considerado um subscritor.</span><span class="sxs-lookup"><span data-stu-id="b2b70-129">In this case, Stream Analytics would be considered a subscriber.</span></span>

<span data-ttu-id="b2b70-130">Para os nossos motores das aeronaves, iremos definir a nossa arquitetura para que os Hubs de Eventos autentiquem as comunicações dos nossos motores.</span><span class="sxs-lookup"><span data-stu-id="b2b70-130">For our aircraft engines, we'll set up our architecture so that Event Hubs will authenticate the communications from our engines.</span></span> <span data-ttu-id="b2b70-131">Em seguida, vamos utilizar a Captura para guardar todos os dados para o Azure Data Lake e, mais tarde, podemos usar todos esses dados para reparametrizar e melhorar os nossos modelos de aprendizagem automática.</span><span class="sxs-lookup"><span data-stu-id="b2b70-131">We will then have it use Capture to save all the data to Azure Data Lake, later we can use all that data to retrain and improve our machine learning models.</span></span> <span data-ttu-id="b2b70-132">Por fim, as nossas transmissões de eventos serão detetados por subscritores do Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="b2b70-132">Finally, our event streams will be picked up by Azure Stream Analytics subscribers.</span></span> <span data-ttu-id="b2b70-133">O Stream Analytics vai utilizar o nosso modelo de aprendizagem automática para procurar padrões nos dados do sensor que possam indicar problemas.</span><span class="sxs-lookup"><span data-stu-id="b2b70-133">Stream Analytics will use our machine learning model to look for patterns in the sensor data that might indicate problems.</span></span>

<span data-ttu-id="b2b70-134">Uma vez que temos várias partições, e que cada motor envia todos os seus dados para apenas uma partição, cada instância do nosso subscritor do Stream Analytics só precisa lidar com um subconjunto dos nossos dados gerais, em vez de filtrar e a correlacionar todos eles.</span><span class="sxs-lookup"><span data-stu-id="b2b70-134">Because we have several partitions, and each engine sends all its data to only one partition each instance of our Stream Analytics subscriber only need deal with a subset of our overall data instead of filtering and correlating over all of it.</span></span>

## <a name="choose-event-grid-or-event-hub"></a><span data-ttu-id="b2b70-135">Optar pelo Event Grid ou Hub de Eventos</span><span class="sxs-lookup"><span data-stu-id="b2b70-135">Choose Event Grid or Event Hub</span></span>

<span data-ttu-id="b2b70-136">Ambos suportam a semântica *Pelo Menos Uma Vez*.</span><span class="sxs-lookup"><span data-stu-id="b2b70-136">Both support *At Least Once* semantics.</span></span>

<span data-ttu-id="b2b70-137">Se precisar de uma infraestrutura de publicação-subscrição de eventos simples com publicadores fidedignos (por exemplo, o seu próprio servidor Web), deve escolher o Azure Event Grid.</span><span class="sxs-lookup"><span data-stu-id="b2b70-137">If you need a simple event publish-subscribe infrastructure with trusted publishers (for instance your own web server), you should choose Azure Event Grid.</span></span>

### <a name="consider-event-hub-if"></a><span data-ttu-id="b2b70-138">Considere o Hub de Eventos se:</span><span class="sxs-lookup"><span data-stu-id="b2b70-138">Consider Event Hub if</span></span>
* <span data-ttu-id="b2b70-139">precisar de autenticar um grande número de publicadores;</span><span class="sxs-lookup"><span data-stu-id="b2b70-139">You need to support authenticating a large number of publishers</span></span>
* <span data-ttu-id="b2b70-140">precisar de guardar uma transmissão de eventos para o Azure Data Lake ou Armazenamento de Blobs;</span><span class="sxs-lookup"><span data-stu-id="b2b70-140">You need to save a stream of events to Azure Data Lake or Blob Storage</span></span>
* <span data-ttu-id="b2b70-141">precisar de agregação ou análise na sua transmissão de eventos</span><span class="sxs-lookup"><span data-stu-id="b2b70-141">You need aggregation or analytics on your event stream</span></span>
* <span data-ttu-id="b2b70-142">precisar de mensagens fiáveis ou resiliência.</span><span class="sxs-lookup"><span data-stu-id="b2b70-142">You need reliable messaging or resiliency</span></span> 