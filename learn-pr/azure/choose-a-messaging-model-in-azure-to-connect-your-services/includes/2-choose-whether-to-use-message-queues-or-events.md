<span data-ttu-id="e3a24-101">Suponha que está a planear a arquitetura de uma aplicação distribuída de partilha de música.</span><span class="sxs-lookup"><span data-stu-id="e3a24-101">Suppose you are planning the architecture of a distributed music-sharing application.</span></span> <span data-ttu-id="e3a24-102">Deve certificar-se de que a aplicação é tão fiável e escalável quanto possível e de que pretende utilizar tecnologias do Azure para criar uma infraestrutura de comunicação robusta.</span><span class="sxs-lookup"><span data-stu-id="e3a24-102">You want to ensure that the application is as reliable and scalable as possible and you intend to use Azure technologies to build a robust communication infrastructure.</span></span>

<span data-ttu-id="e3a24-103">Antes de escolher a tecnologia certa do Azure, tem de compreender todas as comunicações individuais que os componentes da aplicação trocam.</span><span class="sxs-lookup"><span data-stu-id="e3a24-103">Before you can choose the right Azure technology, you must understand each individual communication that the components of the application exchange.</span></span> <span data-ttu-id="e3a24-104">Para todas as comunicações, pode escolher uma tecnologia diferente do Azure.</span><span class="sxs-lookup"><span data-stu-id="e3a24-104">For each communication you can choose a different Azure technology.</span></span>

<span data-ttu-id="e3a24-105">A primeira coisa a entender sobre uma comunicação é se envia mensagens ou eventos.</span><span class="sxs-lookup"><span data-stu-id="e3a24-105">The first thing to understand about a communication is whether it sends messages or events.</span></span> <span data-ttu-id="e3a24-106">Algumas tecnologias do Azure visam eventos e outras visam mensagens, pelo que esta é uma escolha fundamental.</span><span class="sxs-lookup"><span data-stu-id="e3a24-106">Some Azure technologies target events and other target messages so this is a fundamental choice.</span></span>

## <a name="what-is-a-message"></a><span data-ttu-id="e3a24-107">O que é uma mensagem?</span><span class="sxs-lookup"><span data-stu-id="e3a24-107">What is a message?</span></span>

<span data-ttu-id="e3a24-108">Na terminologia de aplicações distribuídas, as **mensagens** têm as seguintes características:</span><span class="sxs-lookup"><span data-stu-id="e3a24-108">In the terminology of distributed applications, **messages** have the following characteristics:</span></span>

- <span data-ttu-id="e3a24-109">Uma mensagem contém dados não processados, produzidos por um componente, que será consumida por outro componente.</span><span class="sxs-lookup"><span data-stu-id="e3a24-109">A message contains raw data, produced by one component, that will be consumed by another component.</span></span>
- <span data-ttu-id="e3a24-110">Uma mensagem contém os dados em si, não apenas uma referência a esses dados.</span><span class="sxs-lookup"><span data-stu-id="e3a24-110">A message contains the data itself, not just a reference to that data.</span></span>
- <span data-ttu-id="e3a24-111">O componente de envio espera que o conteúdo da mensagem seja processado de uma determinada forma pelo componente de destino.</span><span class="sxs-lookup"><span data-stu-id="e3a24-111">The sending component expects the message content to be processed in a certain way by the destination component.</span></span> <span data-ttu-id="e3a24-112">A integridade do sistema global pode depender do remetente e do receptor ao fazer uma tarefa específica.</span><span class="sxs-lookup"><span data-stu-id="e3a24-112">The integrity of the overall system may depend on both sender and receiver doing a specific job.</span></span>

<span data-ttu-id="e3a24-113">Por exemplo, suponha que um utilizador carrega uma música nova ao utilizar a aplicação móvel de partilha de música.</span><span class="sxs-lookup"><span data-stu-id="e3a24-113">For example, suppose a user uploads a new song by using the mobile music-sharing app.</span></span> <span data-ttu-id="e3a24-114">A aplicação móvel tem de enviar essa música para a API Web que é executada no Azure.</span><span class="sxs-lookup"><span data-stu-id="e3a24-114">The mobile app must send that song to the web API that runs in Azure.</span></span> <span data-ttu-id="e3a24-115">O próprio ficheiro de suporte de dados de música tem de ser enviado, e não apenas um alerta que indica que foi adicionada uma nova música.</span><span class="sxs-lookup"><span data-stu-id="e3a24-115">The song media file itself must be sent, not just an alert that indicates that a new song has been added.</span></span> <span data-ttu-id="e3a24-116">A aplicação móvel espera que a API Web armazene a nova música na base de dados e disponibilize-a a outros utilizadores.</span><span class="sxs-lookup"><span data-stu-id="e3a24-116">The mobile app expects that the web API will store the new song in the database and make it available to other users.</span></span> <span data-ttu-id="e3a24-117">Este é um exemplo de uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="e3a24-117">This is an example of a message.</span></span>

## <a name="what-is-an-event"></a><span data-ttu-id="e3a24-118">O que é um evento?</span><span class="sxs-lookup"><span data-stu-id="e3a24-118">What is an event?</span></span>

<span data-ttu-id="e3a24-119">Os **eventos** são mais leves do que as mensagens e são geralmente utilizados para comunicações de difusão.</span><span class="sxs-lookup"><span data-stu-id="e3a24-119">**Events** are lighter-weight than messages and are most often used for broadcast communications.</span></span> <span data-ttu-id="e3a24-120">Os componentes que enviam o evento são conhecidos como **publicadores** e os recetores são conhecidos como **subscritores**.</span><span class="sxs-lookup"><span data-stu-id="e3a24-120">The components sending the event are known as **publishers** and receivers are known as **subscribers**.</span></span>

<span data-ttu-id="e3a24-121">Com os eventos, os componentes de receção geralmente decidem em que comunicações estão interessados e "inscrevem-se" neles.</span><span class="sxs-lookup"><span data-stu-id="e3a24-121">With events, receiving components will generally decide in which communications they are interested and "subscribe" to those.</span></span> <span data-ttu-id="e3a24-122">A subscrição é, normalmente, gerida por um intermediário, como o Azure Event Grid ou o Hub de Eventos do Azure.</span><span class="sxs-lookup"><span data-stu-id="e3a24-122">The subscription is usually managed by an intermediary like Azure Event Grid or Azure Event Hub.</span></span> <span data-ttu-id="e3a24-123">Quando os publicadores enviam um evento, o intermediário irá encaminhar esse evento aos subscritores interessados.</span><span class="sxs-lookup"><span data-stu-id="e3a24-123">When publishers send an event, the intermediary will route that event to interested subscribers.</span></span> <span data-ttu-id="e3a24-124">Isto é conhecido como uma "arquitetura de publicação-subscrição", não é a única forma de lidar com eventos, mas é a mais comum.</span><span class="sxs-lookup"><span data-stu-id="e3a24-124">This is known as a "publish-subscribe architecture", it is not the only way to deal with events, but it is the most common.</span></span>

<span data-ttu-id="e3a24-125">Os eventos têm as seguintes características:</span><span class="sxs-lookup"><span data-stu-id="e3a24-125">Events have the following characteristics:</span></span>

- <span data-ttu-id="e3a24-126">Um evento é uma notificação simples que indica que algo aconteceu.</span><span class="sxs-lookup"><span data-stu-id="e3a24-126">An event is a lightweight notification that indicates that something happened.</span></span>
- <span data-ttu-id="e3a24-127">O evento pode ser enviado para vários recetores ou para nenhum.</span><span class="sxs-lookup"><span data-stu-id="e3a24-127">The event may be sent to multiple receivers or to none at all.</span></span>
- <span data-ttu-id="e3a24-128">Os eventos destinam-se, muitas vezes, a "fan-out" (distribuição) ou têm um grande número de subscritores para cada publicador.</span><span class="sxs-lookup"><span data-stu-id="e3a24-128">Events are often intended to "fan-out" or have a large number of subscribers for each publisher.</span></span>
- <span data-ttu-id="e3a24-129">O publicador do evento não tem qualquer expectativa sobre a ação de um componente de receção.</span><span class="sxs-lookup"><span data-stu-id="e3a24-129">The publisher of the event has no expectation about the action a receiving component takes.</span></span>
- <span data-ttu-id="e3a24-130">Alguns eventos são unidades discretas e não relacionadas com outros eventos.</span><span class="sxs-lookup"><span data-stu-id="e3a24-130">Some events are discrete units and unrelated to other events.</span></span> 
- <span data-ttu-id="e3a24-131">Alguns eventos fazem parte de uma série ordenada e relacionada.</span><span class="sxs-lookup"><span data-stu-id="e3a24-131">Some events are part of a related and ordered series.</span></span>  

<span data-ttu-id="e3a24-132">Por exemplo, suponha que o carregamento de ficheiros de música foi concluído e foi adicionada a música nova à base de dados.</span><span class="sxs-lookup"><span data-stu-id="e3a24-132">For example, suppose the music file upload has been completed and the new song has been added to the database.</span></span> <span data-ttu-id="e3a24-133">Para informar os utilizadores sobre o novo ficheiro, a API Web deve informar os utilizadores de aplicações móveis e de front-end da Web sobre o novo ficheiro.</span><span class="sxs-lookup"><span data-stu-id="e3a24-133">In order to inform users of the new file, the web API must inform the web front-end and mobile app users of the new file.</span></span> <span data-ttu-id="e3a24-134">Os utilizadores podem optar se querem ouvir a música nova, pelo que a notificação inicial não inclui o ficheiro de música, mas apenas notifica os utilizadores de que a música existe.</span><span class="sxs-lookup"><span data-stu-id="e3a24-134">The users can choose whether to listen to the new song, so the initial notification does not include the music file but only notifies users that the song exists.</span></span> <span data-ttu-id="e3a24-135">O remetente não tem uma expectativa específica de que os recetores de eventos farão nada específico em resposta à receção deste evento.</span><span class="sxs-lookup"><span data-stu-id="e3a24-135">The sender does not have a specific expectation that the event receivers will do anything particular in response the receiving this event.</span></span>

<span data-ttu-id="e3a24-136">Este é um exemplo de um evento discreto.</span><span class="sxs-lookup"><span data-stu-id="e3a24-136">This is an example of a discrete event.</span></span>

## <a name="how-to-choose-messages-or-events"></a><span data-ttu-id="e3a24-137">Como escolher mensagens ou eventos</span><span class="sxs-lookup"><span data-stu-id="e3a24-137">How to choose messages or events</span></span>

<span data-ttu-id="e3a24-138">Uma aplicação única é mais propensa a utilizar eventos para determinados fins e mensagens para outros.</span><span class="sxs-lookup"><span data-stu-id="e3a24-138">A single application is likely to use events for some purposes and messages for others.</span></span> <span data-ttu-id="e3a24-139">Antes de escolher, tem de analisar a sua arquitetura de aplicação e todos os seus casos de utilização para identificar todos os fins diferentes que os seus componentes têm para comunicar entre si.</span><span class="sxs-lookup"><span data-stu-id="e3a24-139">Before you choose, you must analyze your application architecture and all its use cases to identify all the different purposes its components have to communicate with each other.</span></span> 

<span data-ttu-id="e3a24-140">Os eventos têm maior probabilidade de serem utilizados para difusões e costumam ser efémeros, o que significa que uma comunicação pode não ser processada por qualquer recetor se nenhum estiver atualmente inscrito.</span><span class="sxs-lookup"><span data-stu-id="e3a24-140">Events are more likely to be used for broadcasts and are often ephemeral, meaning a communication might not be handled by any receiver if none are currently subscribing.</span></span> <span data-ttu-id="e3a24-141">As mensagens têm maior probabilidade de serem utilizadas quando a aplicação distribuída exige uma garantia de que a comunicação será processada.</span><span class="sxs-lookup"><span data-stu-id="e3a24-141">Messages are more likely to be used where the distributed application requires a guarantee that the communication will be processed.</span></span>

<span data-ttu-id="e3a24-142">Para todas as comunicações, considere a pergunta: o componente de envio espera que a comunicação seja processada de uma determinada forma pelo componente de destino?</span><span class="sxs-lookup"><span data-stu-id="e3a24-142">For each communication consider the question: Does the sending component expect the communication to be processed in a particular way by the destination component?</span></span>

<span data-ttu-id="e3a24-143">Se a resposta for sim, opte por utilizar uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="e3a24-143">If the answer is yes, choose to use a message.</span></span> <span data-ttu-id="e3a24-144">Se a resposta for não, poderá utilizar eventos.</span><span class="sxs-lookup"><span data-stu-id="e3a24-144">If the answer is no, you may be able to use events.</span></span>

## <a name="summary"></a><span data-ttu-id="e3a24-145">Resumo</span><span class="sxs-lookup"><span data-stu-id="e3a24-145">Summary</span></span>

<span data-ttu-id="e3a24-146">Os componentes de uma aplicação distribuída comunicam entre si para muitas finalidades diferentes.</span><span class="sxs-lookup"><span data-stu-id="e3a24-146">The components of a distributed application communicate with each other for many different purposes.</span></span> <span data-ttu-id="e3a24-147">Para cada um destes fins, tem de escolher se pretende utilizar os eventos ou mensagens de forma a que possa escolher uma tecnologia do Azure que foi concebida para esse fim.</span><span class="sxs-lookup"><span data-stu-id="e3a24-147">For each of these purposes, you must choose whether to use events or messages so that you can choose an Azure technology that is designed for that purpose.</span></span> 

<span data-ttu-id="e3a24-148">Depois de ter compreendido por que os componentes comunicam e por que utilizam mensagens ou eventos, pode avançar para a escolha de filas de Armazenamento do Azure, Hubs de Eventos, Event Grids ou Service Bus para trocar as informações.</span><span class="sxs-lookup"><span data-stu-id="e3a24-148">Having understood why your components communicate and whether they use events or messages, you can proceed to choose from Azure Storage queues, Event Hubs, Event Grids, or Service Bus to exchange the information.</span></span>